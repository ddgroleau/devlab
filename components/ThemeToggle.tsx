import React, { memo, useEffect, useMemo, useState } from "react";
import {Span} from "@/components/Typography";
import {classNames, conditional} from "@/utils/styleUtils";

const ThemeToggle = ({navIsOpen}:{navIsOpen:boolean}) => {
    const [theme, setTheme] = useState<string|undefined>(undefined);
    const isDarkTheme = theme !== "light";

    const setColorMode = (theme:string) => {
        document.documentElement.setAttribute("class",theme);
        localStorage.setItem("theme",theme);
        setTheme(theme);
    };

    useEffect(()=> {
        setColorMode(localStorage.getItem("theme") || "light");
    },[]);

    const handleClick = () => {
        const theme = isDarkTheme ? "light" : "dark";
        setColorMode(theme);
    };

    return (
        !theme ? <></> :
            <div className={classNames("items-center z-3 ml-8",conditional(navIsOpen,"flex","hidden lg:flex"))}>
                <svg className="mr-2" width="28" height="28" viewBox="0 0 46 42" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <path
                        className={conditional(isDarkTheme,
                            "fill-accent opacity-100",
                            "fill-secondary dark:fill-dark-secondary opacity-25")}
                        // eslint-disable-next-line max-len
                        d={"M22.7469 36.6985C18.0594 36.6985 14.0751 35.2037 10.7938 32.2141C7.51257 29.2246 5.87195 25.5944 5.87195 21.3235C5.87195 17.0527 7.51257 13.4225 10.7938 10.4329C14.0751 7.44331 18.0594 5.94852 22.7469 5.94852C22.9969 5.94852 23.2626 5.95563 23.5438 5.96987C23.8251 5.98411 24.1844 6.00546 24.6219 6.03393C23.4969 6.94504 22.6219 8.0697 21.9969 9.40789C21.3719 10.7461 21.0594 12.1555 21.0594 13.636C21.0594 16.1985 22.0438 18.3766 24.0126 20.1704C25.9813 21.9641 28.3719 22.861 31.1844 22.861C32.8094 22.861 34.3563 22.5976 35.8251 22.0709C37.2938 21.5442 38.5282 20.811 39.5282 19.8714C39.5594 20.2131 39.5829 20.4907 39.5985 20.7042C39.6141 20.9178 39.6219 21.1242 39.6219 21.3235C39.6219 25.5944 37.9813 29.2246 34.7001 32.2141C31.4188 35.2037 27.4344 36.6985 22.7469 36.6985Z"}
                        fill="#D9D9D9"/>
                </svg>
                <button className="inline-block relative h-[28px] w-[60px]" onClick={handleClick}>
                    <Span className={classNames(
                        "absolute bottom-0 left-0 right-0 top-0 cursor-pointer",
                        "bg-slider dark:dark-bg-slider rounded-2xl",
                        conditional(isDarkTheme, "active")
                    )}>
                        <span className={classNames(
                            "bg-round dark:dark-bg-round border border-roundBorder left-[34px] top-[2px]",
                            "absolute rounded-2xl h-[24px] w-[24px]",
                            conditional(isDarkTheme, "translate-x-[-32px]")
                        )}></span>
                    </Span>
                </button>
                <svg className="ml-2" width="28" height="28"  viewBox="0 0 45 41" fill="none" 
                    xmlns="http://www.w3.org/2000/svg">
                    <path
                        className={conditional(!isDarkTheme,
                            "fill-accent opacity-100",
                            "fill-secondary dark:fill-dark-secondary opacity-25")}
                        // eslint-disable-next-line max-len
                        d={"M22.5 29.0417C19.9062 29.0417 17.6953 28.2089 15.8672 26.5432C14.0391 24.8776 13.125 22.8632 13.125 20.5C13.125 18.1368 14.0391 16.1224 15.8672 14.4568C17.6953 12.7912 19.9062 11.9583 22.5 11.9583C25.0938 11.9583 27.3047 12.7912 29.1328 14.4568C30.9609 16.1224 31.875 18.1368 31.875 20.5C31.875 22.8632 30.9609 24.8776 29.1328 26.5432C27.3047 28.2089 25.0938 29.0417 22.5 29.0417ZM3.28125 21.7813C2.875 21.7813 2.53906 21.6603 2.27344 21.4182C2.00781 21.1762 1.875 20.8702 1.875 20.5C1.875 20.1299 2.00781 19.8238 2.27344 19.5818C2.53906 19.3398 2.875 19.2188 3.28125 19.2188H7.96875C8.375 19.2188 8.71094 19.3398 8.97656 19.5818C9.24219 19.8238 9.375 20.1299 9.375 20.5C9.375 20.8702 9.24219 21.1762 8.97656 21.4182C8.71094 21.6603 8.375 21.7813 7.96875 21.7813H3.28125ZM37.0312 21.7813C36.625 21.7813 36.2891 21.6603 36.0234 21.4182C35.7578 21.1762 35.625 20.8702 35.625 20.5C35.625 20.1299 35.7578 19.8238 36.0234 19.5818C36.2891 19.3398 36.625 19.2188 37.0312 19.2188H41.7188C42.125 19.2188 42.4609 19.3398 42.7266 19.5818C42.9922 19.8238 43.125 20.1299 43.125 20.5C43.125 20.8702 42.9922 21.1762 42.7266 21.4182C42.4609 21.6603 42.125 21.7813 41.7188 21.7813H37.0312ZM22.5 8.54168C22.0938 8.54168 21.7578 8.42067 21.4922 8.17866C21.2266 7.93664 21.0938 7.63057 21.0938 7.26043V2.98959C21.0938 2.61945 21.2266 2.31338 21.4922 2.07136C21.7578 1.82935 22.0938 1.70834 22.5 1.70834C22.9062 1.70834 23.2422 1.82935 23.5078 2.07136C23.7734 2.31338 23.9062 2.61945 23.9062 2.98959V7.26043C23.9062 7.63057 23.7734 7.93664 23.5078 8.17866C23.2422 8.42067 22.9062 8.54168 22.5 8.54168ZM22.5 39.2917C22.0938 39.2917 21.7578 39.1707 21.4922 38.9287C21.2266 38.6866 21.0938 38.3806 21.0938 38.0104V33.7396C21.0938 33.3695 21.2266 33.0634 21.4922 32.8214C21.7578 32.5794 22.0938 32.4583 22.5 32.4583C22.9062 32.4583 23.2422 32.5794 23.5078 32.8214C23.7734 33.0634 23.9062 33.3695 23.9062 33.7396V38.0104C23.9062 38.3806 23.7734 38.6866 23.5078 38.9287C23.2422 39.1707 22.9062 39.2917 22.5 39.2917ZM11.25 12.0438L8.57812 9.65209C8.29687 9.39584 8.16406 9.08977 8.17969 8.73387C8.19531 8.37796 8.32812 8.07189 8.57812 7.81564C8.85937 7.55939 9.19531 7.43126 9.58594 7.43126C9.97656 7.43126 10.3125 7.55939 10.5938 7.81564L13.2188 10.25C13.4688 10.5063 13.5938 10.8052 13.5938 11.1469C13.5938 11.4886 13.4688 11.7733 13.2188 12.0011C12.9688 12.2573 12.6484 12.3854 12.2578 12.3854C11.8672 12.3854 11.5312 12.2715 11.25 12.0438ZM34.4062 33.1844L31.7813 30.75C31.5313 30.4938 31.4062 30.1877 31.4062 29.8318C31.4062 29.4759 31.5469 29.184 31.8281 28.9563C32.0781 28.7 32.3906 28.5719 32.7656 28.5719C33.1406 28.5719 33.4688 28.7 33.75 28.9563L36.4219 31.3479C36.7031 31.6042 36.8359 31.9103 36.8203 32.2662C36.8047 32.6221 36.6719 32.9281 36.4219 33.1844C36.1406 33.4406 35.8047 33.5688 35.4141 33.5688C35.0234 33.5688 34.6875 33.4406 34.4062 33.1844ZM31.7813 12.0438C31.5 11.7875 31.3594 11.4886 31.3594 11.1469C31.3594 10.8052 31.5 10.5063 31.7813 10.25L34.4062 7.81564C34.6875 7.55939 35.0234 7.43838 35.4141 7.45262C35.8047 7.46685 36.1406 7.58786 36.4219 7.81564C36.7031 8.07189 36.8438 8.37796 36.8438 8.73387C36.8438 9.08977 36.7031 9.39584 36.4219 9.65209L33.75 12.0438C33.5 12.2715 33.1797 12.3854 32.7891 12.3854C32.3984 12.3854 32.0625 12.2715 31.7813 12.0438ZM8.57812 33.1844C8.29687 32.9281 8.15625 32.6221 8.15625 32.2662C8.15625 31.9103 8.29687 31.6042 8.57812 31.3479L11.25 28.9563C11.5312 28.7 11.8594 28.5719 12.2344 28.5719C12.6094 28.5719 12.9375 28.7 13.2188 28.9563C13.5 29.2125 13.6406 29.5115 13.6406 29.8531C13.6406 30.1948 13.5 30.4938 13.2188 30.75L10.5938 33.1844C10.3125 33.4406 9.97656 33.5616 9.58594 33.5474C9.19531 33.5332 8.85937 33.4122 8.57812 33.1844Z"}
                        fill="#2AE8BA"/>
                </svg>
            </div>
    );
};

export default memo(ThemeToggle);